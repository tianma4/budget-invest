PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE `user` (`uid` INTEGER PRIMARY KEY NOT NULL, `username` TEXT NOT NULL, `email` TEXT NOT NULL, `nickname` TEXT NOT NULL, `password` TEXT NOT NULL, `salt` TEXT NOT NULL, `custom_avatar_type` TEXT NULL, `default_account_id` INTEGER NULL, `transaction_edit_scope` INTEGER NOT NULL, `language` TEXT NULL, `default_currency` TEXT NOT NULL, `first_day_of_week` INTEGER NOT NULL, `fiscal_year_start` INTEGER NULL, `calendar_display_type` INTEGER NULL, `date_display_type` INTEGER NULL, `long_date_format` INTEGER NULL, `short_date_format` INTEGER NULL, `long_time_format` INTEGER NULL, `short_time_format` INTEGER NULL, `fiscal_year_format` INTEGER NULL, `currency_display_type` INTEGER NULL, `numeral_system` INTEGER NULL, `decimal_separator` INTEGER NULL, `digit_grouping_symbol` INTEGER NULL, `digit_grouping` INTEGER NULL, `coordinate_display_type` INTEGER NULL, `expense_amount_color` INTEGER NULL, `income_amount_color` INTEGER NULL, `feature_restriction` INTEGER NULL, `disabled` INTEGER NULL, `deleted` INTEGER NOT NULL, `email_verified` INTEGER NOT NULL, `created_unix_time` INTEGER NULL, `updated_unix_time` INTEGER NULL, `deleted_unix_time` INTEGER NULL, `last_login_unix_time` INTEGER NULL);
CREATE TABLE `two_factor` (`uid` INTEGER PRIMARY KEY NOT NULL, `secret` TEXT NOT NULL, `created_unix_time` INTEGER NULL);
CREATE TABLE `two_factor_recovery_code` (`uid` INTEGER NOT NULL, `recovery_code` TEXT NOT NULL, `used` INTEGER NOT NULL, `created_unix_time` INTEGER NULL, `used_unix_time` INTEGER NULL, PRIMARY KEY (`uid`,`recovery_code`));
CREATE TABLE `token_record` (`uid` INTEGER NOT NULL, `user_token_id` INTEGER NOT NULL, `token_type` INTEGER NOT NULL, `secret` TEXT NOT NULL, `user_agent` TEXT NULL, `created_unix_time` INTEGER NOT NULL, `expired_unix_time` INTEGER NULL, `last_seen_unix_time` INTEGER NULL, PRIMARY KEY (`uid`,`user_token_id`,`created_unix_time`));
CREATE TABLE `account` (`account_id` INTEGER PRIMARY KEY NOT NULL, `uid` INTEGER NOT NULL, `deleted` INTEGER NOT NULL, `category` INTEGER NOT NULL, `type` INTEGER NOT NULL, `parent_account_id` INTEGER NOT NULL, `name` TEXT NOT NULL, `display_order` INTEGER NOT NULL, `icon` INTEGER NOT NULL, `color` TEXT NOT NULL, `currency` TEXT NOT NULL, `balance` INTEGER NOT NULL, `comment` TEXT NOT NULL, `extend` BLOB NULL, `hidden` INTEGER NOT NULL, `created_unix_time` INTEGER NULL, `updated_unix_time` INTEGER NULL, `deleted_unix_time` INTEGER NULL);
CREATE TABLE `transaction` (`transaction_id` INTEGER PRIMARY KEY NOT NULL, `uid` INTEGER NOT NULL, `deleted` INTEGER NOT NULL, `type` INTEGER NOT NULL, `category_id` INTEGER NOT NULL, `account_id` INTEGER NOT NULL, `transaction_time` INTEGER NOT NULL, `timezone_utc_offset` INTEGER NOT NULL, `amount` INTEGER NOT NULL, `related_id` INTEGER NOT NULL, `related_account_id` INTEGER NOT NULL, `related_account_amount` INTEGER NOT NULL, `hide_amount` INTEGER NOT NULL, `comment` TEXT NOT NULL, `geo_longitude` REAL NULL, `geo_latitude` REAL NULL, `created_ip` TEXT NULL, `scheduled_created` INTEGER NULL, `created_unix_time` INTEGER NULL, `updated_unix_time` INTEGER NULL, `deleted_unix_time` INTEGER NULL);
CREATE TABLE `transaction_category` (`category_id` INTEGER PRIMARY KEY NOT NULL, `uid` INTEGER NOT NULL, `deleted` INTEGER NOT NULL, `type` INTEGER NOT NULL, `parent_category_id` INTEGER NOT NULL, `name` TEXT NOT NULL, `display_order` INTEGER NOT NULL, `icon` INTEGER NOT NULL, `color` TEXT NOT NULL, `hidden` INTEGER NOT NULL, `comment` TEXT NOT NULL, `created_unix_time` INTEGER NULL, `updated_unix_time` INTEGER NULL, `deleted_unix_time` INTEGER NULL);
CREATE TABLE `transaction_tag` (`tag_id` INTEGER PRIMARY KEY NOT NULL, `uid` INTEGER NOT NULL, `deleted` INTEGER NOT NULL, `name` TEXT NOT NULL, `display_order` INTEGER NOT NULL, `hidden` INTEGER NOT NULL, `created_unix_time` INTEGER NULL, `updated_unix_time` INTEGER NULL, `deleted_unix_time` INTEGER NULL);
CREATE TABLE `transaction_tag_index` (`tag_index_id` INTEGER PRIMARY KEY NOT NULL, `uid` INTEGER NULL, `deleted` INTEGER NOT NULL, `transaction_time` INTEGER NOT NULL, `tag_id` INTEGER NULL, `transaction_id` INTEGER NULL, `created_unix_time` INTEGER NULL, `updated_unix_time` INTEGER NULL, `deleted_unix_time` INTEGER NULL);
CREATE TABLE `transaction_template` (`template_id` INTEGER PRIMARY KEY NOT NULL, `uid` INTEGER NOT NULL, `deleted` INTEGER NOT NULL, `template_type` INTEGER NOT NULL, `name` TEXT NOT NULL, `type` INTEGER NOT NULL, `category_id` INTEGER NOT NULL, `account_id` INTEGER NOT NULL, `scheduled_frequency_type` INTEGER NULL, `scheduled_frequency` TEXT NULL, `scheduled_start_time` INTEGER NULL, `scheduled_end_time` INTEGER NULL, `scheduled_at` INTEGER NULL, `scheduled_timezone_utc_offset` INTEGER NULL, `tag_ids` TEXT NOT NULL, `amount` INTEGER NOT NULL, `related_account_id` INTEGER NOT NULL, `related_account_amount` INTEGER NOT NULL, `hide_amount` INTEGER NOT NULL, `comment` TEXT NOT NULL, `display_order` INTEGER NOT NULL, `hidden` INTEGER NOT NULL, `created_unix_time` INTEGER NULL, `updated_unix_time` INTEGER NULL, `deleted_unix_time` INTEGER NULL);
CREATE TABLE `transaction_picture_info` (`uid` INTEGER NOT NULL, `deleted` INTEGER NOT NULL, `transaction_id` INTEGER NOT NULL, `picture_id` INTEGER PRIMARY KEY NOT NULL, `picture_extension` TEXT NOT NULL, `created_ip` TEXT NULL, `created_unix_time` INTEGER NULL, `updated_unix_time` INTEGER NULL, `deleted_unix_time` INTEGER NULL);
CREATE TABLE `user_custom_exchange_rate` (`uid` INTEGER NOT NULL, `deleted_unix_time` INTEGER NOT NULL, `currency` TEXT NOT NULL, `rate` INTEGER NOT NULL, `created_unix_time` INTEGER NULL, `updated_unix_time` INTEGER NULL, PRIMARY KEY (`uid`,`deleted_unix_time`,`currency`));
CREATE TABLE `user_application_cloud_setting` (`uid` INTEGER PRIMARY KEY NOT NULL, `settings` BLOB NULL, `updated_unix_time` INTEGER NULL);
CREATE UNIQUE INDEX `UQE_user_username` ON `user` (`username`);
CREATE UNIQUE INDEX `UQE_user_email` ON `user` (`email`);
CREATE INDEX `IDX_token_record_uid_type_expired_time` ON `token_record` (`uid`,`token_type`,`expired_unix_time`);
CREATE INDEX `IDX_token_record_expired_time` ON `token_record` (`uid`,`expired_unix_time`);
CREATE INDEX `IDX_account_uid_deleted_parent_account_id_order` ON `account` (`uid`,`deleted`,`parent_account_id`,`display_order`);
CREATE UNIQUE INDEX `UQE_transaction_uid_time` ON `transaction` (`uid`,`transaction_time`);
CREATE INDEX `IDX_transaction_uid_deleted_category_id_time` ON `transaction` (`uid`,`deleted`,`category_id`,`transaction_time`);
CREATE INDEX `IDX_transaction_uid_deleted_account_id_time` ON `transaction` (`uid`,`deleted`,`account_id`,`transaction_time`);
CREATE INDEX `IDX_transaction_uid_deleted_time_longitude_latitude` ON `transaction` (`uid`,`deleted`,`geo_longitude`,`geo_latitude`);
CREATE INDEX `IDX_transaction_uid_deleted_time` ON `transaction` (`uid`,`deleted`,`transaction_time`);
CREATE INDEX `IDX_transaction_uid_deleted_type_time` ON `transaction` (`uid`,`deleted`,`type`,`transaction_time`);
CREATE INDEX `IDX_transaction_uid_deleted_type_account_id_time` ON `transaction` (`uid`,`deleted`,`type`,`account_id`,`transaction_time`);
CREATE INDEX `IDX_category_uid_deleted_type_parent_category_id_order` ON `transaction_category` (`uid`,`deleted`,`type`,`parent_category_id`,`display_order`);
CREATE INDEX `IDX_tag_uid_deleted_order` ON `transaction_tag` (`uid`,`deleted`,`display_order`);
CREATE INDEX `IDX_transaction_tag_index_uid_deleted_tag_id_transaction_id` ON `transaction_tag_index` (`uid`,`deleted`,`tag_id`,`transaction_id`);
CREATE INDEX `IDX_transaction_tag_index_uid_deleted_transaction_time_tag_id` ON `transaction_tag_index` (`uid`,`deleted`,`transaction_time`,`tag_id`);
CREATE INDEX `IDX_transaction_tag_index_uid_deleted_transaction_id` ON `transaction_tag_index` (`uid`,`deleted`,`transaction_id`);
CREATE INDEX `IDX_transaction_template_uid_deleted_template_type_order` ON `transaction_template` (`uid`,`deleted`,`template_type`,`display_order`);
CREATE INDEX `IDX_transaction_template_deleted_type_freqtype_scheduled_time` ON `transaction_template` (`deleted`,`template_type`,`scheduled_frequency_type`,`scheduled_start_time`,`scheduled_end_time`,`scheduled_at`);
CREATE INDEX `IDX_transaction_picture_uid_deleted_picture_id` ON `transaction_picture_info` (`uid`,`deleted`,`picture_id`);
CREATE INDEX `IDX_transaction_picture_uid_deleted_transaction_id_picture_id` ON `transaction_picture_info` (`uid`,`deleted`,`transaction_id`,`picture_id`);
COMMIT;
